import math
from PyQt5.QtWidgets import QMainWindow
from matplotlib import pyplot as plt

from Ui_LoadingWindow import Ui_LoadingWindow


class LoadingWindow(QMainWindow, Ui_LoadingWindow):

    def __init__(self, parent=None):
        super(LoadingWindow, self).__init__(parent)

        self.setupUi(self)
        self.setWindowTitle("Loading Window")
        self.showButton.clicked.connect(self.show_results)

    def plotgraph(self, irate):

        inf_cities = {'Абаза': 1.3862943611198906,
                      'Абакан': 1.3862943611198906,
                      'Абдулино': 2.079441541679836,
                      'Абинск': 2.8903717578961645,
                      'Агрыз': 2.7080502011022096,
                      'Азнакаево': 2.7080502011022096,
                      'Азов': 1.0986122886681096,
                      'Аксай': 1.0986122886681096,
                      'Алапаевск': 3.218875824868201,
                      'Алатырь': 0.6931471805599453,
                      'Алдан': 2.772588722239781,
                      'Алейск': 0.6931471805599453,
                      'Александров': 1.0986122886681096,
                      'Александровск': 2.5649493574615367,
                      'Алексеевка': 1.6094379124341005,
                      'Алексин': 2.5649493574615367,
                      'Алзамай': 1.0986122886681096,
                      'Алушта': 1.791759469228055,
                      'Альметьевск': 2.7080502011022096,
                      'Анапа': 2.8903717578961645,
                      'Ангарск': 1.0986122886681096,
                      'Андреаполь': 1.6094379124341005,
                      'Анжеро-Судженск': 0.6931471805599453,
                      'Апатиты': 1.791759469228055,
                      'Арамиль': 3.218875824868201,
                      'Аргун': 2.302585092994046,
                      'Ардатов': 1.3862943611198906,
                      'Арзамас': 2.3978952727983707,
                      'Аркадак': 1.6094379124341005,
                      'Армавир': 2.8903717578961645,
                      'Арсеньев': 1.0986122886681096,
                      'Арск': 2.7080502011022096,
                      'Артём': 1.0986122886681096,
                      'Артёмовск': 2.7080502011022096,
                      'Артёмовский': 3.218875824868201,
                      'Архангельск': 2.079441541679836,
                      'Асбест': 3.218875824868201,
                      'Асино': 1.3862943611198906,
                      'Аткарск': 1.6094379124341005,
                      'Ачинск': 2.7080502011022096,
                      'Аша': 2.7080502011022096,
                      'Бабаево': 1.0986122886681096,
                      'Бабушкин': 2.63905732961526,
                      'Бавлы': 2.7080502011022096,
                      'Байкальск': 1.0986122886681096,
                      'Баксан': 1.9459101490553128,
                      'Балабаново': 1.3862943611198906,
                      'Балаково': 1.6094379124341005,
                      'Балашиха': 4.718498871295094,
                      'Балашов': 1.6094379124341005,
                      'Барабинск': 2.302585092994046,
                      'Барнаул': 0.6931471805599453,
                      'Барыш': 0.6931471805599453,
                      'Батайск': 1.0986122886681096,
                      'Бежецк': 1.6094379124341005,
                      'Белая Калитва': 1.0986122886681096,
                      'Белгород': 1.6094379124341005,
                      'Белинский': 2.079441541679836,
                      'Белово': 0.6931471805599453,
                      'Белогорск': 1.791759469228055,
                      'Белозерск': 1.0986122886681096,
                      'Белокуриха': 0.6931471805599453,
                      'Белорецк': 1.791759469228055,
                      'Белореченск': 2.8903717578961645,
                      'Белоярский': 1.791759469228055,
                      'Белый': 1.6094379124341005,
                      'Бердск': 2.302585092994046,
                      'Березники': 2.5649493574615367,
                      'Бийск': 0.6931471805599453,
                      'Бикин': 2.079441541679836,
                      'Благовещенск': 1.791759469228055,
                      'Благодарный': 1.9459101490553128,
                      'Бобров': 1.9459101490553128,
                      'Богданович': 3.218875824868201,
                      'Богородицк': 2.5649493574615367,
                      'Боготол': 2.7080502011022096,
                      'Богучар': 1.9459101490553128,
                      'Бодайбо': 1.0986122886681096,
                      'Бокситогорск': 2.3978952727983707,
                      'Болгар': 2.7080502011022096,
                      'Бологое': 1.6094379124341005,
                      'Болотное': 2.302585092994046,
                      'Болхов': 1.3862943611198906,
                      'Бор': 2.3978952727983707,
                      'Борисоглебск': 1.9459101490553128,
                      'Боровичи': 1.3862943611198906,
                      'Бородино': 2.7080502011022096,
                      'Братск': 1.0986122886681096,
                      'Бронницы': 4.718498871295094,
                      'Брянск': 1.3862943611198906,
                      'Бугульма': 2.7080502011022096,
                      'Бугуруслан': 2.079441541679836,
                      'Будённовск': 1.9459101490553128,
                      'Бузулук': 2.079441541679836,
                      'Буинск': 2.7080502011022096,
                      'Буй': 0.6931471805599453,
                      'Бутурлиновка': 1.9459101490553128,
                      'Валдай': 1.3862943611198906,
                      'Валуйки': 1.6094379124341005,
                      'Велиж': 0.6931471805599453,
                      'Великие Луки': 2.302585092994046,
                      'Великий Устюг': 1.0986122886681096,
                      'Вельск': 2.079441541679836,
                      'Верещагино': 2.5649493574615367,
                      'Верея': 4.718498871295094,
                      'Верхнеуральск': 2.7080502011022096,
                      'Верхний Тагил': 3.218875824868201,
                      'Верхний Уфалей': 2.7080502011022096,
                      'Верхняя Салда': 3.218875824868201,
                      'Верхняя Тура': 3.218875824868201,
                      'Верхотурье': 3.218875824868201,
                      'Весьегонск': 1.6094379124341005,
                      'Вилюйск': 2.772588722239781,
                      'Вихоревка': 1.0986122886681096,
                      'Вичуга': 2.302585092994046,
                      'Владивосток': 1.0986122886681096,
                      'Владимир': 1.0986122886681096,
                      'Волгоград': 1.6094379124341005,
                      'Волгодонск': 1.0986122886681096,
                      'Волгореченск': 0.6931471805599453,
                      'Волжск': 1.0986122886681096,
                      'Волжский': 1.6094379124341005,
                      'Вологда': 1.0986122886681096,
                      'Волоколамск': 4.718498871295094,
                      'Волхов': 2.3978952727983707,
                      'Волчанск': 3.218875824868201,
                      'Вольск': 1.6094379124341005,
                      'Воркута': 3.1354942159291497,
                      'Воронеж': 1.9459101490553128,
                      'Воскресенск': 4.718498871295094,
                      'Воткинск': 1.6094379124341005,
                      'Вуктыл': 3.1354942159291497,
                      'Выборг': 2.3978952727983707,
                      'Выкса': 2.3978952727983707,
                      'Вытегра': 1.0986122886681096,
                      'Вышний Волочёк': 1.6094379124341005,
                      'Вяземский': 2.079441541679836,
                      'Вязники': 1.0986122886681096,
                      'Вязьма': 0.6931471805599453,
                      'Вятские Поляны': 2.5649493574615367,
                      'Гаврилов Посад': 2.302585092994046,
                      'Гаврилов-Ям': 1.3862943611198906,
                      'Гагарин': 0.6931471805599453,
                      'Галич': 0.6931471805599453,
                      'Гатчина': 2.3978952727983707,
                      'Гдов': 2.302585092994046,
                      'Геленджик': 2.8903717578961645,
                      'Георгиевск': 1.9459101490553128,
                      'Глазов': 1.6094379124341005,
                      'Голицыно': 4.718498871295094,
                      'Горнозаводск': 2.5649493574615367,
                      'Горняк': 0.6931471805599453,
                      'Городовиковск': 0.6931471805599453,
                      'Гороховец': 1.0986122886681096,
                      'Горячий Ключ': 2.8903717578961645,
                      'Гремячинск': 2.5649493574615367,
                      'Грозный': 2.302585092994046,
                      'Грязи': 2.079441541679836,
                      'Грязовец': 1.0986122886681096,
                      'Губаха': 2.5649493574615367,
                      'Губкин': 1.6094379124341005,
                      'Гудермес': 2.302585092994046,
                      'Гуково': 1.0986122886681096,
                      'Гулькевичи': 2.8903717578961645,
                      'Гурьевск': 0.6931471805599453,
                      'Гусиноозёрск': 2.63905732961526,
                      'Гусь-Хрустальный': 1.0986122886681096,
                      'Давлеканово': 1.791759469228055,
                      'Далматово': 0.6931471805599453,
                      'Дальнегорск': 1.0986122886681096,
                      'Дальнереченск': 1.0986122886681096,
                      'Данилов': 1.3862943611198906,
                      'Данков': 2.079441541679836,
                      'Дегтярск': 3.218875824868201,
                      'Демидов': 0.6931471805599453,
                      'Дербент': 1.6094379124341005,
                      'Десногорск': 0.6931471805599453,
                      'Дзержинск': 2.3978952727983707,
                      'Дивногорск': 2.7080502011022096,
                      'Димитровград': 0.6931471805599453,
                      'Дмитров': 4.718498871295094,
                      'Дно': 2.302585092994046,
                      'Добрянка': 2.5649493574615367,
                      'Долинск': 1.6094379124341005,
                      'Домодедово': 4.718498871295094,
                      'Донецк': 1.0986122886681096,
                      'Донской': 2.5649493574615367,
                      'Дорогобуж': 0.6931471805599453,
                      'Дубна': 4.718498871295094,
                      'Дубовка': 1.6094379124341005,
                      'Духовщина': 0.6931471805599453,
                      'Дюртюли': 1.791759469228055,
                      'Дятьково': 1.3862943611198906,
                      'Евпатория': 1.791759469228055,
                      'Егорьевск': 4.718498871295094,
                      'Ейск': 2.8903717578961645,
                      'Екатеринбург': 3.218875824868201,
                      'Елабуга': 2.7080502011022096,
                      'Елец': 2.079441541679836,
                      'Ельня': 0.6931471805599453,
                      'Еманжелинск': 2.7080502011022096,
                      'Емва': 3.1354942159291497,
                      'Енисейск': 2.7080502011022096,
                      'Ершов': 1.6094379124341005,
                      'Ессентуки': 1.9459101490553128,
                      'Железноводск': 1.9459101490553128,
                      'Железногорск-Илимский': 1.0986122886681096,
                      'Жердевка': 1.3862943611198906,
                      'Жигулёвск': 2.7080502011022096,
                      'Жиздра': 1.3862943611198906,
                      'Жирновск': 1.6094379124341005,
                      'Жуковка': 1.3862943611198906,
                      'Завитинск': 0.6931471805599453,
                      'Заводоуковск': 1.0986122886681096,
                      'Заволжск': 2.302585092994046,
                      'Задонск': 2.079441541679836,
                      'Заинск': 2.7080502011022096,
                      'Заозёрный': 2.7080502011022096,
                      'Западная Двина': 1.6094379124341005,
                      'Зарайск': 4.718498871295094,
                      'Заречный': 3.218875824868201,
                      'Заринск': 0.6931471805599453,
                      'Звенигород': 4.718498871295094,
                      'Зверево': 1.0986122886681096,
                      'Зеленодольск': 2.7080502011022096,
                      'Зеленокумск': 1.9459101490553128,
                      'Зима': 1.0986122886681096,
                      'Златоуст': 2.7080502011022096,
                      'Злынка': 1.3862943611198906,
                      'Змеиногорск': 0.6931471805599453,
                      'Зубцов': 1.6094379124341005,
                      'Зуевка': 2.5649493574615367,
                      'Ивангород': 2.3978952727983707,
                      'Иваново': 2.302585092994046,
                      'Ивдель': 3.218875824868201,
                      'Игарка': 2.7080502011022096,
                      'Ижевск': 1.6094379124341005,
                      'Избербаш': 1.6094379124341005,
                      'Изобильный': 1.9459101490553128,
                      'Иланский': 2.7080502011022096,
                      'Инза': 0.6931471805599453,
                      'Инсар':
                          1.3862943611198906,
                      'Инта': 3.1354942159291497,
                      'Ипатово': 1.9459101490553128,
                      'Ирбит': 3.218875824868201,
                      'Иркутск': 1.0986122886681096,
                      'Исилькуль': 1.3862943611198906,
                      'Искитим': 2.302585092994046,
                      'Ишим': 1.0986122886681096,
                      'Ишимбай': 1.791759469228055,
                      'Йошкар-Ола': 1.0986122886681096,
                      'Казань': 2.7080502011022096,
                      'Калач': 1.9459101490553128,
                      'Калач-на-Дону': 1.6094379124341005,
                      'Калачинск': 1.3862943611198906,
                      'Калининград': 2.302585092994046,
                      'Калининск': 1.6094379124341005,
                      'Калуга': 1.3862943611198906,
                      'Калязин': 1.6094379124341005,
                      'Камбарка': 1.6094379124341005,
                      'Каменка': 2.079441541679836,
                      'Каменногорск': 2.3978952727983707,
                      'Каменск-Уральский': 3.218875824868201,
                      'Каменск-Шахтинский': 1.0986122886681096,
                      'Камень-на-Оби': 0.6931471805599453,
                      'Камешково': 1.0986122886681096,
                      'Камышин': 1.6094379124341005,
                      'Камышлов': 3.218875824868201,
                      'Канаш': 0.6931471805599453,
                      'Кандалакша': 1.791759469228055,
                      'Канск': 2.7080502011022096,
                      'Карабаш': 2.7080502011022096,
                      'Карасук': 2.302585092994046,
                      'Карачев': 1.3862943611198906,
                      'Каргат': 2.302585092994046,
                      'Карпинск': 3.218875824868201,
                      'Карталы': 2.7080502011022096,
                      'Касимов': 1.791759469228055,
                      'Касли': 2.7080502011022096,
                      'Катав-Ивановск': 2.7080502011022096,
                      'Катайск': 0.6931471805599453,
                      'Качканар': 3.218875824868201,
                      'Кашин': 1.6094379124341005,
                      'Кашира': 4.718498871295094,
                      'Кемерово': 0.6931471805599453,
                      'Керчь': 1.791759469228055,
                      'Кизел': 2.5649493574615367,
                      'Кизилюрт': 1.6094379124341005,
                      'Кизляр': 1.6094379124341005,
                      'Кимры': 1.6094379124341005,
                      'Кингисепп': 2.3978952727983707,
                      'Кинель': 2.7080502011022096,
                      'Кинешма': 2.302585092994046,
                      'Киренск': 1.0986122886681096,
                      'Киржач': 1.0986122886681096,
                      'Кириллов': 1.0986122886681096,
                      'Кириши': 2.3978952727983707,
                      'Киров': 2.5649493574615367,
                      'Кировград': 3.218875824868201,
                      'Кирсанов': 1.3862943611198906,
                      'Киселёвск': 0.6931471805599453,
                      'Кисловодск': 1.9459101490553128,
                      'Клин': 4.718498871295094,
                      'Клинцы': 1.3862943611198906,
                      'Ковров': 1.0986122886681096,
                      'Ковылкино': 1.3862943611198906,
                      'Когалым': 1.791759469228055,
                      'Кодинск': 2.7080502011022096,
                      'Козельск': 1.3862943611198906,
                      'Козьмодемьянск': 1.0986122886681096,
                      'Кола': 1.791759469228055,
                      'Коломна': 4.718498871295094,
                      'Колпашево': 1.3862943611198906,
                      'Кольчугино': 1.0986122886681096,
                      'Комсомольск': 2.302585092994046,
                      'Комсомольск-на-Амуре': 2.079441541679836,
                      'Конаково': 1.6094379124341005,
                      'Кондрово': 1.3862943611198906,
                      'Кораблино': 1.791759469228055,
                      'Кореновск': 2.8903717578961645,
                      'Коркино': 2.7080502011022096,
                      'Короча': 1.6094379124341005,
                      'Коряжма': 2.079441541679836,
                      'Кострома': 0.6931471805599453,
                      'Котельниково': 1.6094379124341005,
                      'Котельнич': 2.5649493574615367,
                      'Котлас': 2.079441541679836,
                      'Котово': 1.6094379124341005,
                      'Красноармейск': 1.6094379124341005,
                      'Красновишерск': 2.5649493574615367,
                      'Краснодар': 2.8903717578961645,
                      'Краснокамск': 2.5649493574615367,
                      'Краснослободск': 1.3862943611198906,
                      'Краснотурьинск': 3.218875824868201,
                      'Красноуральск': 3.218875824868201,
                      'Красноуфимск': 3.218875824868201,
                      'Красноярск': 2.7080502011022096,
                      'Красный Кут': 1.6094379124341005,
                      'Красный Сулин': 1.0986122886681096,
                      'Красный Холм': 1.6094379124341005,
                      'Кропоткин': 2.8903717578961645,
                      'Крымск': 2.8903717578961645,
                      'Кстово': 2.3978952727983707,
                      'Кубинка': 4.718498871295094,
                      'Кувандык': 2.079441541679836,
                      'Кувшиново': 1.6094379124341005,
                      'Кудымкар': 2.5649493574615367,
                      'Кузнецк': 2.079441541679836,
                      'Кулебаки': 2.3978952727983707,
                      'Кумертау': 1.791759469228055,
                      'Кунгур': 2.5649493574615367,
                      'Купино': 2.302585092994046,
                      'Курган': 0.6931471805599453,
                      'Курганинск': 2.8903717578961645,
                      'Курильск': 1.6094379124341005,
                      'Куртамыш': 0.6931471805599453,
                      'Куса': 2.7080502011022096,
                      'Кушва': 3.218875824868201,
                      'Кыштым': 2.7080502011022096,
                      'Лабинск': 2.8903717578961645,
                      'Лаишево': 2.7080502011022096,
                      'Лакинск': 1.0986122886681096,
                      'Лангепас': 1.791759469228055,
                      'Лебедянь': 2.079441541679836,
                      'Лениногорск': 2.7080502011022096,
                      'Ленинск': 1.6094379124341005,
                      'Ленинск-Кузнецкий': 0.6931471805599453,
                      'Ленск': 2.772588722239781,
                      'Лесной': 3.218875824868201,
                      'Лесозаводск': 1.0986122886681096,
                      'Лесосибирск': 2.7080502011022096,
                      'Ливны': 1.3862943611198906,
                      'Липецк': 2.079441541679836,
                      'Лиски': 1.9459101490553128,
                      'Лихославль': 1.6094379124341005,
                      'Лобня': 4.718498871295094,
                      'Лодейное Поле': 2.3978952727983707,
                      'Луга': 2.3978952727983707,
                      'Луза': 2.5649493574615367,
                      'Лукоянов': 2.3978952727983707,
                      'Луховицы': 4.718498871295094,
                      'Лысково': 2.3978952727983707,
                      'Лысьва': 2.5649493574615367,
                      'Любань': 2.3978952727983707,
                      'Любим': 1.3862943611198906,
                      'Людиново': 1.3862943611198906,
                      'Магнитогорск': 2.7080502011022096,
                      'Майкоп': 1.6094379124341005,
                      'Майский': 1.9459101490553128,
                      'Макаров': 1.6094379124341005,
                      'Макарьев': 0.6931471805599453,
                      'Макушино': 0.6931471805599453,
                      'Малая Вишера': 1.3862943611198906,
                      'Малоархангельск': 1.3862943611198906,
                      'Малоярославец': 1.3862943611198906}

        y = inf_cities.values()
        numbins = 10
        n, bins, patches = plt.hist(y, bins=numbins, color='darkblue')
        ind_spec = math.floor(numbins * (irate - min(y)) / (max(y) - min(y)))
        patches[ind_spec].set_fc('orange')
        plt.xlabel('Коэффициент заражения')
        plt.ylabel('Частота')
        plt.savefig("/Users/admin/Desktop/graph.jpg")
        plt.show()

    def show_results(self):
        file = open("/Users/admin/Desktop/predict.txt", "r")
        irate = 0
        for line in file:
            irate = float(line)
        irate = round(irate, 2)
        self.plotgraph(irate)
        self.label2.setText(f"{irate}")


